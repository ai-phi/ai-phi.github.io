---
import { SITE, LOCALE } from "@config";

interface Props {
  title: string;
  date?: string | Date;
  author?: string;
  description?: string;
  ogImage?: string;
  href: string;
}

const {
  title,
  date,
  author = SITE.author ?? "AI-Phi",
  description,
  ogImage,
  href,
} = Astro.props as Props;

const fallbackImage = "/og/ai-phi-default-og.webp";
const resolvedImage =
  typeof ogImage === "string" && ogImage.length > 0 ? ogImage : fallbackImage;

const dateValue = date ? new Date(date) : null;
const displayDate = dateValue
  ? dateValue.toLocaleDateString(LOCALE.langTag, {
      year: "numeric",
      month: "short",
      day: "numeric",
      timeZone: LOCALE.timeZone ?? "Europe/Paris",
    })
  : "";
const displayTime = dateValue
  ? dateValue.toLocaleTimeString(LOCALE.langTag, {
      hour: "2-digit",
      minute: "2-digit",
      hour12: false,
      timeZone: LOCALE.timeZone ?? "Europe/Paris",
    })
  : "";
---

<article class="group relative flex h-full flex-col rounded-2xl border border-skin-line/40 bg-[rgb(var(--color-card-muted))] p-5 shadow-lg shadow-black/10 hover:shadow-xl transition-shadow transition-transform hover:-translate-y-0.5
">

  <!-- Media -->
  <div class="w-full min-h-72 md:min-h-80 lg:min-h-96 bg-[rgb(var(--color-card-image-bg))] rounded-xl overflow-hidden">
    <img
      src={resolvedImage}
      alt="Illustration"
      class="block w-full h-full object-contain rounded-xl"
      loading="lazy"
      decoding="async"
    />
  </div>

  <!-- Stretched link -->
  <a
    href={href}
    class="absolute inset-0 z-10 rounded-2xl focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-skin-accent"
    aria-label={`Open ${title}`}
  ></a>

  <!-- Content -->
  <div class="relative z-20 mt-4 flex h-full flex-col pointer-events-none">
    <h3 class="text-2xl font-semibold leading-tight text-skin-base transition-colors duration-150
           group-hover:text-3xl">
      {title}
    </h3>

    {dateValue && (
      <p class="mt-2 text-base font-medium text-skin-base opacity-80">
        <time datetime={dateValue.toISOString()}>{displayDate}</time>
        <span aria-hidden="true"> · </span>
        <span class="text-nowrap">{displayTime}</span>
        <span aria-hidden="true"> · </span>by {author}
      </p>
    )}

    {description && (
      <p class="mt-3 grow text-base leading-relaxed text-skin-base opacity-80 text-justify">
        {description}
      </p>
    )}

    <!-- Visual CTA -->
    <div class="mt-auto pt-4">
      <span class="inline-flex items-center gap-1 font-medium transition-all duration-150
             group-hover:font-bold text-skin-base cursor-pointer">
        Check details
        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 transition-transform duration-150 group-hover:translate-x-0.5" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" > <path d="m13 5 7 7-7 7M4 12h16" /> </svg>
      </span>
    </div>
  </div>
</article>

